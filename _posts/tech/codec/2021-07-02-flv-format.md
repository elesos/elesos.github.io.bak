---
layout: post
title: FLV格式
date: 2021-07-02 21:27:19 +0800
categories: [艺搜科技,多媒体]
tags: [多媒体]
---

由一个个TAG组成

## 头

刚开始是9字节的头（看第5个字节就行，它代表类型，其它基本都是固定值）：前3个字节固定为FLV（46 4C 56）

第5个字节：

```
TypeFlagsReserved UB[5] 0
TypeFlagsAudio    UB[1] 1 = 有音频
TypeFlagsReserved UB[1] 0
TypeFlagsVideo    UB[1] 1 = 有视频
```

所以，**为1时，只有视频，为4时只有音频，为5时都有**。

最后4个字节：固定为00 00 00 09

## 内容

9个字节之后就由连续的 **pre_tag_size（4个字节）+tag** 组成，其中第一个pre_tag_size固定为00 00 00 00

## tag

tag前面为**11个字节**的头：

tag一般分音频和视频tag，通过**第一个字节的后5位**区分，**8音9视**

然后是3个字节的大小（从streamid开始往后算的大小）

然后是4个字节的时间戳。

最后是3个字节的streamID（固定为0)

后面就是数据了,比如:

对于音频，是**音频头+数据**，如果是aac，音频头有2个字节

对于视频，是**视频头+数据**。如果是avc，视频头有5个字节



不支持封装opus
